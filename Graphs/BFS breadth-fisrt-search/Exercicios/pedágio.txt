pedagio(obi 2002)

Como prêmio pelo primeiro lugar nas Olimpíadas Brasileiras de Informática, Juquinha e sua família ganharam uma viagem de uma semana para a Coreia do Sul. Como o país é deslumbrante, com tradições, cultura, arquitetura e culinária muito diferentes do Brasil, o pai de Juquinha, Sr. Juca, decidiu alugar um carro para conhecer melhor o país. As estradas são muito bem conservadas; todas são de mão dupla e duas cidades podem ser conectadas diretamente por mais de uma estrada. No entanto, em todas as estradas há pedágio (um pedágio em cada sentido, entre duas cidades). Como o Sr. Juca não tem muito dinheiro para gastar, as viagens de carro precisam ser muito bem planejadas.

Escreva um programa que, conhecendo as cidades e estradas do país, e sabendo a cidade onde Juquinha e sua família estão, encontre todas as cidades (além da cidade onde eles estão) que podem ser visitadas por eles, dada a restrição de pagamento imposta pelo Sr. Juquinha.
P
Pno máximo pedágios (considerando apenas a viagem de ida).

Entrada
A entrada é composta por vários conjuntos de teste. A primeira linha de um conjunto de teste contém quatro números inteiros.
C
C,
E
E,
L
Le
P
POs valores
C
Ce
E
Eindicam o número de cidades e o número de estradas existentes, respectivamente. Os números inteiros identificam as cidades de 1 a
C
COs valores
L
Le
P
PIndique, respectivamente, a cidade onde a família de Juquinha se encontra neste momento e o número máximo de portagens que o Sr. Juca está disposto a pagar. O seguinte
E
ECada linha contém informações sobre uma estrada, representada por um par de números inteiros positivos.
X
Xe
Y
Y, indicando que existe uma estrada (mão dupla) que sai da cidade
X
Xpara a cidade
Y
YO fim da entrada é indicado por
C=E=L=P=0.

Saída
Para cada conjunto de testes de entrada, seu programa deve produzir três linhas na saída. A primeira linha deve conter um identificador do conjunto de testes, no formato "Teste n" (em português, "teste" significa "teste"), onde
n
nA numeração começa em 1. A segunda linha deve conter os identificadores das cidades alcançáveis, em ordem crescente, separados por pelo menos um espaço em branco. A terceira linha deve ser deixada em branco. A grafia mostrada no exemplo de saída abaixo deve ser seguida rigorosamente.

input:
5 4 2 1
1 2
2 3
3 4
4 5
9 12 1 2
2 1
1 5
2 1
3 2
9 3
3 4
4 8
4 7
7 6
5 6
4 5
3 7
0 0 0 0

output:
Teste 1
1 3

Teste 2
2 3 4 5 6




